const Toast={containerId:"toast-container",defaultDuration:2500,errorDuration:5e3,getContainer(){let e=document.getElementById(this.containerId);return e||(e=document.createElement("div"),e.id=this.containerId,document.body.appendChild(e)),e},show(e,t=this.defaultDuration){this._create(e,"success",t)},error(e,t=this.errorDuration){this._create(e,"error",t,!0)},info(e,t=this.defaultDuration){this._create(e,"info",t)},_create(e,t="success",i,o=!1){const s=this.getContainer(),n=document.createElement("div");n.className=`toast toast--${t}`;const a=document.createElement("span");if(a.className="toast__message",a.innerText=e,n.appendChild(a),o){const r=document.createElement("button");r.className="toast__copy",r.innerHTML="[COPY]",r.title="Copy error to clipboard",r.onclick=c=>{c.stopPropagation(),navigator.clipboard.writeText(e).then(()=>{r.innerHTML="[COPIED]",setTimeout(()=>r.innerHTML="[COPY]",1e3)}).catch(()=>{r.innerHTML="[FAILED]",setTimeout(()=>r.innerHTML="[COPY]",1e3)})},n.appendChild(r)}s.appendChild(n);const l=setTimeout(()=>{this._dismiss(n)},i);n.addEventListener("click",r=>{r.target.classList.contains("toast__copy")||(clearTimeout(l),this._dismiss(n))})},_dismiss(e){e.style.animation="slideOut 0.2s ease forwards",setTimeout(()=>e.remove(),200)}},Theme={STORAGE_KEY:"theme",EVENT_NAME:"themechange",THEMES:["light","dark","industrial-punchcard","matrix","t800","synthwave","pipboy","rivendell","camo","barbie","ocean"],THEME_LABELS:{light:"Light",dark:"Dark","industrial-punchcard":"Industrial",matrix:"Matrix",t800:"T-800",synthwave:"Synthwave",pipboy:"Pip-Boy",rivendell:"Rivendell",camo:"Camo",barbie:"Barbie",ocean:"Ocean"},_initialized:!1,_observer:null,init(){if(this._initialized)return;this._initialized=!0;let e="light";try{const t=localStorage.getItem(this.STORAGE_KEY);this.THEMES.includes(t)?e=t:e=this._detectSystemTheme()}catch{e=this._detectSystemTheme()}this._applyTheme(e),this._hydrateDropdowns(),this._setupStorageListener(),this._setupMutationObserver(),this._setupThemeListener(),this._setupKeyboardShortcut(),this._setupSystemThemeListener()},get(){return document.documentElement.getAttribute("data-theme")||"light"},set(e,t={}){const{notify:i=!0,broadcast:o=!0}=t;this.THEMES.includes(e)||(console.warn(`Theme: Invalid theme "${e}", falling back to light`),e="light");const s=this.get();if(s!==e){this._applyTheme(e);try{localStorage.setItem(this.STORAGE_KEY,e)}catch(n){console.warn("Theme: Could not persist preference:",n.message)}o&&this._dispatchChange(e,s),i&&typeof Toast<"u"&&Toast.show(`VISUAL MODE: ${this.THEME_LABELS[e].toUpperCase()}`)}},cycle(){const e=this.get(),t=this.THEMES.indexOf(e),i=this.THEMES[(t+1)%this.THEMES.length];this.set(i)},toggle(){this.cycle()},onChange(e){this.set(e.target.value)},subscribe(e){const t=i=>e(i.detail.theme,i.detail.previousTheme);return window.addEventListener(this.EVENT_NAME,t),()=>window.removeEventListener(this.EVENT_NAME,t)},_applyTheme(e){document.documentElement.setAttribute("data-theme",e),this._hydrateDropdowns()},_hydrateDropdowns(){const e=this.get();document.querySelectorAll(".theme-dropdown").forEach(t=>{t.value!==e&&(t.value=e)})},_dispatchChange(e,t){const i=new CustomEvent(this.EVENT_NAME,{bubbles:!0,detail:{theme:e,previousTheme:t}});window.dispatchEvent(i)},_setupStorageListener(){window.addEventListener("storage",e=>{if(e.key===this.STORAGE_KEY&&e.newValue){const t=e.newValue;this.THEMES.includes(t)&&t!==this.get()&&(this._applyTheme(t),this._dispatchChange(t,this.get()))}})},_setupMutationObserver(){typeof MutationObserver>"u"||(this._observer=new MutationObserver(e=>{for(const t of e)for(const i of t.addedNodes)i.nodeType===Node.ELEMENT_NODE&&(i.classList?.contains("theme-dropdown")?i.value=this.get():i.querySelectorAll&&i.querySelectorAll(".theme-dropdown").forEach(o=>{o.value=this.get()}))}),this._observer.observe(document.body,{childList:!0,subtree:!0}))},_setupThemeListener(){window.addEventListener(this.EVENT_NAME,()=>{this._hydrateDropdowns()})},_detectSystemTheme(){return typeof window>"u"||!window.matchMedia?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},_setupSystemThemeListener(){if(typeof window>"u"||!window.matchMedia)return;window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{try{localStorage.getItem(this.STORAGE_KEY)||this.set(t.matches?"dark":"light")}catch{this.set(t.matches?"dark":"light")}})},_setupKeyboardShortcut(){document.addEventListener("keydown",e=>{const t=e.target.tagName.toLowerCase();t==="input"||t==="textarea"||e.target.isContentEditable||e.ctrlKey||e.altKey||e.metaKey||(e.key==="t"||e.key==="T")&&(this.cycle(),e.preventDefault())})},destroy(){this._observer&&(this._observer.disconnect(),this._observer=null),this._initialized=!1}},ThemePicker={_isOpen:!1,_picker:null,_toggle:null,_menu:null,init(){this._picker=document.querySelector(".theme-picker"),this._picker&&(this._toggle=this._picker.querySelector(".theme-picker-toggle"),this._menu=this._picker.querySelector(".theme-picker-menu"),this._updateSelection(),document.addEventListener("click",e=>{this._isOpen&&!this._picker.contains(e.target)&&this.close()}),this._picker.addEventListener("keydown",e=>this._handleKeydown(e)),Theme.subscribe(()=>this._updateSelection()))},toggle(){this._isOpen?this.close():this.open()},open(){if(!this._picker)return;this._isOpen=!0,this._picker.setAttribute("aria-expanded","true"),this._toggle.setAttribute("aria-expanded","true");const e=this._menu.querySelector(".theme-picker-option");e&&e.focus()},close(){this._picker&&(this._isOpen=!1,this._picker.setAttribute("aria-expanded","false"),this._toggle.setAttribute("aria-expanded","false"))},select(e){Theme.set(e),this.close(),this._toggle.focus()},_updateSelection(){if(!this._menu)return;const e=Theme.get();this._menu.querySelectorAll(".theme-picker-option").forEach(t=>{const i=t.dataset.theme===e;t.setAttribute("aria-selected",i?"true":"false")})},_handleKeydown(e){const t=Array.from(this._menu.querySelectorAll(".theme-picker-option")),i=t.findIndex(o=>o===document.activeElement);switch(e.key){case"Escape":this.close(),this._toggle.focus(),e.preventDefault();break;case"ArrowDown":if(!this._isOpen)this.open();else{const o=i<t.length-1?i+1:0;t[o].focus()}e.preventDefault();break;case"ArrowUp":if(this._isOpen){const o=i>0?i-1:t.length-1;t[o].focus()}e.preventDefault();break;case"Enter":case" ":this._isOpen&&document.activeElement.classList.contains("theme-picker-option")?this.select(document.activeElement.dataset.theme):this._isOpen||this.open(),e.preventDefault();break;case"Tab":this._isOpen&&this.close();break}}};typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Theme.init(),ThemePicker.init()}):(Theme.init(),ThemePicker.init()));const MatrixRain={canvas:null,ctx:null,animationId:null,columns:[],fontSize:14,_initialized:!1,_unsubscribe:null,chars:"\u30A1\u30AB\u30B5\u30BF\u30CA\u30CF\u30DE\u30E4\u30E9\u30EF\u30AC\u30B6\u30C0\u30D0\u30D1\u30A4\u30AD\u30B7\u30C1\u30CB\u30D2\u30DF\u30EA\u30AE\u30B8\u30D3\u30D4\u30A6\u30AF\u30B9\u30C4\u30CC\u30D5\u30E0\u30E6\u30EB\u30B0\u30BA\u30D7\u30A8\u30B1\u30BB\u30C6\u30CD\u30D8\u30E1\u30EC\u30B2\u30BC\u30D9\u30DA\u30AA\u30B3\u30BD\u30C8\u30CE\u30DB\u30E2\u30E8\u30ED\u30B4\u30BE\u30DC\u30DD0123456789",init(){this._initialized||(this._initialized=!0,typeof Theme<"u"&&(this._unsubscribe=Theme.subscribe((e,t)=>{e==="matrix"?this.start():t==="matrix"&&this.stop()}),Theme.get()==="matrix"&&this.start()))},start(){window.matchMedia("(prefers-reduced-motion: reduce)").matches||this.canvas||(this._createCanvas(),this._initColumns(),window.addEventListener("resize",this._boundResize=this._resize.bind(this)),this._loop())},stop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.canvas?.parentNode&&this.canvas.parentNode.removeChild(this.canvas),window.removeEventListener("resize",this._boundResize),this.canvas=null,this.ctx=null,this.columns=[]},_createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.id="matrix-rain",this.canvas.setAttribute("aria-hidden","true");const e=this.canvas.style;e.cssText="position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;pointer-events:none;",this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx=this.canvas.getContext("2d",{alpha:!1}),this.ctx.fillStyle="#0D0208",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),document.body.insertBefore(this.canvas,document.body.firstChild)},_initColumns(){const e=Math.ceil(this.canvas.width/this.fontSize);this.columns=new Array(e);for(let t=0;t<e;t++)this.columns[t]={y:Math.random()*this.canvas.height*-.5,speed:4+Math.random()*8,nextChar:0}},_resize(){this.canvas&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this._initColumns())},_loop(){this._draw(),this.animationId=requestAnimationFrame(()=>this._loop())},_draw(){const e=this.ctx,t=this.canvas.width,i=this.canvas.height,o=this.fontSize,s=this.chars,n=s.length;e.fillStyle="rgba(13, 2, 8, 0.05)",e.fillRect(0,0,t,i),e.font=o+"px monospace";for(let a=0,l=this.columns.length;a<l;a++){const r=this.columns[a],c=a*o,d=r.y;d>-o&&d<i+o&&(e.fillStyle="#FFF",e.fillText(s[r.nextChar++%n],c,d),d-o>0&&(e.fillStyle="#0F0",e.fillText(s[(r.nextChar+5)%n],c,d-o)),d-o*2>0&&(e.fillStyle="#090",e.fillText(s[(r.nextChar+10)%n],c,d-o*2))),r.y+=r.speed,r.y>i+o*3&&(r.y=Math.random()*-100,r.speed=4+Math.random()*8)}},destroy(){this.stop(),this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null),this._initialized=!1}};typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>MatrixRain.init()):MatrixRain.init());const Modal={elementId:"article-modal",articles:null,articlesPath:"/content/articles.json",getElement(){return document.getElementById(this.elementId)},async loadArticles(){if(this.articles)return this.articles;try{const e=await fetch(this.articlesPath);if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();return this.articles={},t.articles.forEach(i=>{this.articles[i.id]=i}),this.articles}catch(e){return console.warn("Failed to load articles:",e.message),typeof Toast<"u"&&Toast.error("Could not load articles. Check connection."),{}}},open(e){const t=this.getElement(),i=document.getElementById("modal-title"),o=document.getElementById("modal-body");document.body.classList.add("scroll-locked"),i.innerText=`RETRIEVING LOG ${e}...`,o.innerHTML="<p>Decryption in progress...</p>",t.style.display="block",setTimeout(()=>{t.style.opacity=1},10),setTimeout(()=>this.loadContent(e,i,o),500)},close(){const e=this.getElement();e.style.opacity=0,document.body.classList.remove("scroll-locked"),setTimeout(()=>{e.style.display="none"},300)},async loadContent(e,t,i){const s=(await this.loadArticles())[e];if(s){const n=`TIMESTAMP: ${s.date} // ${s.sector}`;t.innerText=s.title,i.textContent="";const a=document.createElement("p");a.className="mono",a.style.color="var(--muted)",a.textContent=n;const l=document.createElement("hr");l.style.cssText="border:0; border-top:1px solid var(--line); margin: 2rem 0;";const r=document.createElement("p");r.textContent=s.body,i.appendChild(a),i.appendChild(l),i.appendChild(r)}else{t.innerText="LOG NOT FOUND",i.textContent="";const n=document.createElement("p");n.textContent="The requested field note could not be retrieved.",i.appendChild(n)}},init(){const e=this.getElement();e&&e.addEventListener("click",t=>{t.target===e&&this.close()}),this.loadArticles()}},Nav={drawerId:"mobile-drawer",overlayId:"mobile-overlay",toggleMobile(){const e=document.getElementById(this.drawerId),t=document.getElementById(this.overlayId);e.classList.contains("open")?(e.classList.remove("open"),t?.classList.remove("open"),document.body.classList.remove("scroll-locked")):(e.classList.add("open"),t?.classList.add("open"),document.body.classList.add("scroll-locked"))},close(){const e=document.getElementById(this.drawerId),t=document.getElementById(this.overlayId);e?.classList.remove("open"),t?.classList.remove("open"),document.body.classList.remove("scroll-locked")},init(){}},SleepMode={PAGE_TIME_REQUIRED:300*1e3,IDLE_TIME_REQUIRED:30*1e3,CHECK_INTERVAL:5e3,TIMING:{OVERLAY_DELAY:300,BREATHING_START:1500,WAKE_FLASH_DURATION:150,OVERLAY_FADE:500,ELEMENT_CLEANUP_DELAY:700,STAGGER_BUTTONS:100,STAGGER_CARDS:150,STAGGER_TEXT:80,STAGGER_NAV:50,STAGGER_STARTLE:30,STARTLED_MARK_DURATION:600},DISPLAY:{MOBILE_BREAKPOINT:768,TOASTERS_PER_200PX:1,TOASTERS_MOBILE:2,Z_COUNT_DESKTOP:8,Z_COUNT_MOBILE:4,ZS_PER_ELEMENT:3},CANVAS:{TOASTER_MIN_SPEED:1,TOASTER_SPEED_RANGE:1.5,WING_SPEED_MIN:5,WING_SPEED_RANGE:5,WRAP_MARGIN:60,PIXEL_SCALE:3},pageLoadTime:Date.now(),lastActivityTime:Date.now(),isAsleep:!1,checkTimer:null,overlay:null,canvas:null,ctx:null,animationFrame:null,toasters:[],zs:[],sleepyElements:[],decorations:[],breathingTimeout:null,resizeHandler:null,wakeHandler:null,SLEEPY_SELECTORS:{buttons:".cta-button, .pricing-cta, .theme-toggle, .menu-toggle",cards:".process-step, .pricing-card, .about-card, .hero-badge, .wiki-category-card",text:".headline, .subhead, .section-label, .about-name, main h1, main h2, main h3",nav:".menu-link",logo:".brand-logo"},prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches},init(){this.pageLoadTime=Date.now(),this.lastActivityTime=Date.now(),this.bindActivityListeners(),this.startChecking(),console.log("%c \u{1F4A4} Psst... stay a while and something might happen... ","background: #4a2c2a; color: #e07b3c; padding: 5px; font-family: monospace; font-size: 10px;")},bindActivityListeners(){const e=()=>{this.lastActivityTime=Date.now()};document.addEventListener("mousemove",e,{passive:!0}),document.addEventListener("keydown",e,{passive:!0}),document.addEventListener("scroll",e,{passive:!0}),document.addEventListener("touchstart",e,{passive:!0})},startChecking(){this.checkTimer=setInterval(()=>this.checkSleepConditions(),this.CHECK_INTERVAL)},checkSleepConditions(){if(this.isAsleep)return;const e=Date.now(),t=e-this.pageLoadTime,i=e-this.lastActivityTime;t>=this.PAGE_TIME_REQUIRED&&i>=this.IDLE_TIME_REQUIRED&&this.enterSleepMode()},enterSleepMode(){this.isAsleep||(this.isAsleep=!0,console.log("%c \u{1F634} FOGSIFT is taking a nap... click anywhere to wake up! ","background: #1a1412; color: #fb923c; padding: 10px; font-family: monospace; font-weight: bold;"),document.body.classList.add("page-sleeping"),this.prefersReducedMotion()||this.putElementsToSleep(),setTimeout(()=>{this.createOverlay(),this.prefersReducedMotion()||(this.initToasters(),this.initZs(),this.startAnimation()),this.wakeHandler=()=>this.wakeUp(),this.overlay.addEventListener("click",this.wakeHandler),this.overlay.addEventListener("touchend",this.wakeHandler,{passive:!0})},this.TIMING.OVERLAY_DELAY))},putElementsToSleep(){this.sleepyElements=[],this.decorations=[],document.querySelectorAll(this.SLEEPY_SELECTORS.buttons).forEach((t,i)=>{setTimeout(()=>{this.prepareElement(t),t.classList.add("sleepy"),this.sleepyElements.push({element:t,type:"button"}),i%2===0&&this.addZzzToElement(t)},i*this.TIMING.STAGGER_BUTTONS)}),document.querySelectorAll(this.SLEEPY_SELECTORS.cards).forEach((t,i)=>{setTimeout(()=>{this.prepareElement(t),t.classList.add("sleepy"),this.sleepyElements.push({element:t,type:"card"}),i<3&&this.addSleepCap(t),i===1&&this.addSnoreBubble(t),this.addZzzToElement(t)},2*this.TIMING.STAGGER_BUTTONS+i*this.TIMING.STAGGER_CARDS)}),document.querySelectorAll(this.SLEEPY_SELECTORS.text).forEach((t,i)=>{setTimeout(()=>{t.classList.add("sleepy"),this.sleepyElements.push({element:t,type:"text"})},this.TIMING.STAGGER_BUTTONS+i*this.TIMING.STAGGER_TEXT)}),document.querySelectorAll(this.SLEEPY_SELECTORS.nav).forEach((t,i)=>{setTimeout(()=>{t.classList.add("sleepy"),this.sleepyElements.push({element:t,type:"nav"})},i*this.TIMING.STAGGER_NAV)});const e=document.querySelector(this.SLEEPY_SELECTORS.logo);e&&setTimeout(()=>{this.prepareElement(e),e.classList.add("sleepy"),this.sleepyElements.push({element:e,type:"logo"}),this.addZzzToElement(e),this.addSleepCap(e)},this.TIMING.STAGGER_BUTTONS),this.breathingTimeout=setTimeout(()=>{this.startBreathing()},this.TIMING.BREATHING_START)},prepareElement(e){window.getComputedStyle(e).position==="static"&&(e.dataset.sleepOriginalPosition="static",e.style.position="relative")},restoreElement(e){e.dataset.sleepOriginalPosition==="static"&&(e.style.position="",delete e.dataset.sleepOriginalPosition)},startBreathing(){this.isAsleep&&this.sleepyElements.forEach(({element:e})=>{e.classList.remove("sleepy"),e.classList.add("sleepy-breathing")})},addZzzToElement(e){const t=document.createElement("div");t.className="element-zzz-container",t.style.cssText="position: absolute; top: -10px; right: -5px; pointer-events: none;";for(let i=0;i<this.DISPLAY.ZS_PER_ELEMENT;i++){const o=document.createElement("span");o.className="element-zzz",o.textContent="z",o.style.animationDelay=`${i*1}s`,t.appendChild(o)}e.appendChild(t),this.decorations.push(t)},addSleepCap(e){const t=document.createElement("span");t.className="sleep-cap",t.textContent="\u{1F9E2}",t.style.cssText="position: absolute; top: -20px; right: -15px; font-size: 1.5rem; transform: rotate(15deg); z-index: 50;",e.appendChild(t),this.decorations.push(t)},addSnoreBubble(e){const t=document.createElement("div");t.className="snore-bubble",t.textContent="zzz...",e.appendChild(t),this.decorations.push(t)},createOverlay(){this.overlay=document.createElement("div"),this.overlay.id="sleep-overlay",this.overlay.innerHTML=`
            <div class="sleep-scanlines"></div>
            <canvas id="sleep-canvas"></canvas>
            <div class="sleep-zs-container"></div>
            <div class="sleep-message">
                <span class="sleep-icon">\u{1F4A4}</span>
                <span class="sleep-text">tap to wake</span>
            </div>
        `,document.body.appendChild(this.overlay),this.canvas=document.getElementById("sleep-canvas"),this.ctx=this.canvas.getContext("2d"),this.resizeCanvas(),this.resizeHandler=()=>this.resizeCanvas(),window.addEventListener("resize",this.resizeHandler,{passive:!0}),requestAnimationFrame(()=>{this.overlay.classList.add("active")})},resizeCanvas(){this.canvas&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight)},drawToaster(e,t,i){const o=this.ctx,s=this.CANVAS.PIXEL_SCALE,n={body:"#c4956a",dark:"#5c3d2e",slot:"#4a2c2a",wing:"#f5f0e6",wingDark:"#d4c4a8",highlight:"#e07b3c"};o.save(),o.translate(e,t),o.fillStyle=n.body,o.fillRect(0,4*s,12*s,8*s),o.fillStyle=n.dark,o.fillRect(0,10*s,12*s,2*s),o.fillStyle=n.slot,o.fillRect(2*s,5*s,3*s,4*s),o.fillRect(7*s,5*s,3*s,4*s),o.fillStyle=n.highlight,o.fillRect(2*s,3*s,3*s,2*s),o.fillRect(7*s,3*s,3*s,2*s);const a=i%2===0?0:-1*s;o.fillStyle=n.wing,o.fillRect(-4*s,(2+a/s)*s,4*s,6*s),o.fillStyle=n.wingDark,o.fillRect(-3*s,(3+a/s)*s,2*s,4*s),o.fillStyle=n.wing,o.fillRect(12*s,(2+a/s)*s,4*s,6*s),o.fillStyle=n.wingDark,o.fillRect(13*s,(3+a/s)*s,2*s,4*s),o.restore()},initToasters(){this.toasters=[];const t=window.innerWidth<this.DISPLAY.MOBILE_BREAKPOINT?this.DISPLAY.TOASTERS_MOBILE:Math.floor(window.innerWidth/200)*this.DISPLAY.TOASTERS_PER_200PX+2;for(let i=0;i<t;i++)this.toasters.push({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,speed:this.CANVAS.TOASTER_MIN_SPEED+Math.random()*this.CANVAS.TOASTER_SPEED_RANGE,wingFrame:Math.floor(Math.random()*10),wingSpeed:this.CANVAS.WING_SPEED_MIN+Math.floor(Math.random()*this.CANVAS.WING_SPEED_RANGE)})},initZs(){const e=this.overlay.querySelector(".sleep-zs-container");if(!e)return;const t=["small","medium","large"],o=window.innerWidth<this.DISPLAY.MOBILE_BREAKPOINT?this.DISPLAY.Z_COUNT_MOBILE:this.DISPLAY.Z_COUNT_DESKTOP;for(let s=0;s<o;s++){const n=document.createElement("div");n.className=`sleep-z ${t[s%3]}`,n.textContent="Z",n.style.left=`${10+Math.random()*80}%`,n.style.animationDelay=`${Math.random()*4}s`,n.style.animationDuration=`${4+Math.random()*3}s`,e.appendChild(n)}},startAnimation(){let e=0;const t=()=>{!this.isAsleep||!this.ctx||(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.toasters.forEach(i=>{i.x+=i.speed,i.y-=i.speed*.6;const o=this.CANVAS.WRAP_MARGIN;i.x>this.canvas.width+o&&(i.x=-o,i.y=Math.random()*this.canvas.height),i.y<-o&&(i.y=this.canvas.height+o,i.x=Math.random()*this.canvas.width),e%i.wingSpeed===0&&i.wingFrame++,this.drawToaster(i.x,i.y,i.wingFrame)}),e++,this.animationFrame=requestAnimationFrame(t))};t()},wakeUp(){this.isAsleep&&(this.prefersReducedMotion()||(this.overlay.classList.add("waking"),this.startleElements()),setTimeout(()=>{this.isAsleep=!1,this.lastActivityTime=Date.now(),this.breathingTimeout&&(clearTimeout(this.breathingTimeout),this.breathingTimeout=null),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null),this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),document.body.classList.remove("page-sleeping"),document.body.classList.add("page-waking"),this.overlay&&(this.overlay.classList.remove("active"),this.overlay.classList.add("fading")),setTimeout(()=>{this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=null,this.canvas=null,this.ctx=null,this.wakeHandler=null,this.cleanupDecorations(),setTimeout(()=>{document.body.classList.remove("page-waking"),this.cleanupElementClasses()},this.TIMING.ELEMENT_CLEANUP_DELAY)},this.TIMING.OVERLAY_FADE),console.log("%c \u2600\uFE0F Good morning! FOGSIFT is awake and ready. ","background: #f5f0e6; color: #4a2c2a; padding: 10px; font-family: monospace; font-weight: bold;")},this.prefersReducedMotion()?0:this.TIMING.WAKE_FLASH_DURATION))},startleElements(){this.sleepyElements.forEach(({element:e,type:t},i)=>{setTimeout(()=>{e.classList.remove("sleepy","sleepy-breathing"),e.classList.add("startled"),t==="card"&&i<3&&this.addStartledMark(e),t==="button"&&i===0&&this.addStartledMark(e)},i*this.TIMING.STAGGER_STARTLE)})},addStartledMark(e){const t=document.createElement("span");t.className="startled-mark",t.textContent="!",t.style.cssText="position: absolute; top: -25px; right: -10px;",e.appendChild(t),this.decorations.push(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},this.TIMING.STARTLED_MARK_DURATION)},cleanupDecorations(){this.decorations.forEach(e=>{e&&e.parentNode&&e.parentNode.removeChild(e)}),this.decorations=[]},cleanupElementClasses(){this.sleepyElements.forEach(({element:e})=>{e.classList.remove("sleepy","sleepy-breathing","startled"),this.restoreElement(e)}),this.sleepyElements=[]}};window.SleepMode=SleepMode,(function(){"use strict";const e="fogsift_",t=e+"build",o={ttl:36e5,get available(){try{const s="__test__";return localStorage.setItem(s,s),localStorage.removeItem(s),!0}catch{return!1}},get(s){if(!this.available)return null;try{const n=localStorage.getItem(e+s);if(!n)return null;const{data:a,timestamp:l,buildTimestamp:r}=JSON.parse(n);if(Date.now()-l>this.ttl)return this._log("expired",s),this.remove(s),null;const c=this._getCurrentBuild();return c&&r&&r!==c?(this._log("build changed",s),this.clear(),null):a}catch(n){return this._log("error",`get ${s}: ${n.message}`),null}},set(s,n){if(this.available)try{const a={data:n,timestamp:Date.now(),buildTimestamp:this._getCurrentBuild()||n.buildTimestamp};localStorage.setItem(e+s,JSON.stringify(a)),this._log("set",s)}catch(a){this._log("error",`set ${s}: ${a.message}`),this._cleanup()}},remove(s){this.available&&localStorage.removeItem(e+s)},isValid(s){return this.get(s)!==null},clear(){if(!this.available)return;const s=Object.keys(localStorage).filter(n=>n.startsWith(e));s.forEach(n=>localStorage.removeItem(n)),this._log("cleared",`${s.length} entries`)},setBuildTimestamp(s){this.available&&localStorage.setItem(t,String(s))},_getCurrentBuild(){if(!this.available)return null;const s=localStorage.getItem(t);return s?parseInt(s,10):null},_cleanup(){if(!this.available)return;const s=[];for(let a=0;a<localStorage.length;a++){const l=localStorage.key(a);if(l.startsWith(e)&&l!==t)try{const r=JSON.parse(localStorage.getItem(l));s.push({key:l,timestamp:r.timestamp})}catch{localStorage.removeItem(l)}}s.sort((a,l)=>a.timestamp-l.timestamp);const n=Math.ceil(s.length/2);s.slice(0,n).forEach(a=>localStorage.removeItem(a.key)),this._log("cleanup",`removed ${n} entries`)},_log(s,n){typeof Debug<"u"&&Debug.log&&Debug.log("Cache",`${s}: ${n}`)}};window.Cache=o})(),(function(){"use strict";const e="fogsift_debug",t="[FOGSIFT]",i={module:"color: #6b7280; font-weight: bold;",api:"color: #059669; font-weight: bold;",component:"color: #7c3aed; font-weight: bold;",error:"color: #dc2626; font-weight: bold;",success:"color: #16a34a;",timing:"color: #d97706;",default:"color: #374151;"},o={enabled:!1,prefix:t,init(){try{this.enabled=localStorage.getItem(e)==="true",this.enabled&&console.log(`%c${t} Debug mode enabled`,i.success)}catch{}},enable(){this.enabled=!0;try{localStorage.setItem(e,"true")}catch{}console.log(`%c${t} Debug mode enabled`,i.success),console.log(`%c${t} Use Debug.disable() to turn off`,i.default)},disable(){this.enabled=!1;try{localStorage.removeItem(e)}catch{}console.log(`%c${t} Debug mode disabled`,i.default)},log(s,n,a){if(!this.enabled)return;const l=new Date().toISOString().split("T")[1].split(".")[0],r=`%c${t} %c[${s}] %c${n}`;a!==void 0?console.log(r,i.default,i.module,i.default,a):console.log(r,i.default,i.module,i.default)},api(s,n,a){if(!this.enabled)return;const l=n>=200&&n<300?i.success:i.error,r=`%c${t} %c[API] %c${s} %c${n} %c(${a}ms)`;console.log(r,i.default,i.api,i.default,l,i.timing)},component(s,n,a){if(!this.enabled)return;const l=`%c${t} %c[${s}] %c${n}`;a!==void 0?console.log(l,i.default,i.component,i.default,a):console.log(l,i.default,i.component,i.default)},error(s,n){const a=n instanceof Error?n.message:n;console.error(`%c${t} %c[${s}] %c${a}`,i.default,i.error,i.error)},group(s,n){this.enabled&&(console.group(`${t} ${s}`),n(),console.groupEnd())},table(s,n){this.enabled&&(console.log(`%c${t} ${s}:`,i.module),console.table(n))}};o.init(),window.Debug=o})(),(function(){"use strict";const e="/api",t={async loadIndex(){return this._fetch("/wiki/index.json")},async loadSitemap(){return this._fetch("/wiki/sitemap.json")},async loadArticles(){return this._fetch("/articles.json")},async loadMeta(){return this._fetch("/meta.json")},async _fetch(i){const o=`${e}${i}`,s=performance.now();try{if(typeof Cache<"u"&&Cache.isValid){const r=Cache.get(i);if(r)return this._log("cache hit",i),r}const n=await fetch(o);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=await n.json(),l=Math.round(performance.now()-s);return this._logApi(i,n.status,l),typeof Cache<"u"&&Cache.set&&Cache.set(i,a),a}catch(n){throw this._log("error",`${i}: ${n.message}`),n}},_logApi(i,o,s){typeof Debug<"u"&&Debug.api&&Debug.api(i,o,s)},_log(i,o){typeof Debug<"u"&&Debug.log&&Debug.log("WikiAPI",`${i}: ${o}`)}};window.WikiAPI=t})();const App={version:"0.0.5",_intervals:[],_konamiCode:["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"],_konamiIndex:0,init(){Nav.init(),Modal.init(),this.initClock(),this.initAccessibility(),this.initRotatingWords(),this.initKonami(),this.initHoneypot(),this.logBoot(),SleepMode.init()},initHoneypot(){document.querySelectorAll('a[data-honeypot="true"]').forEach(e=>{e.addEventListener("click",t=>{const i=e.parentElement.querySelector(".hp-field input");i&&i.checked&&(t.preventDefault(),console.log("%c \u{1F916} Bot detected ","background: #dc2626; color: white; padding: 5px;"))})})},initClock(){const e=document.getElementById("utc-clock");if(!e)return;const t=()=>{const i=new Date;e.textContent=i.toISOString().replace("T"," ").substring(0,19)+" UTC"};t(),this._intervals.push(setInterval(t,1e3))},initAccessibility(){const e=document.querySelector(".theme-toggle");if(e){const s=()=>{const a=document.documentElement.getAttribute("data-theme")==="dark";e.setAttribute("aria-pressed",a?"true":"false")};s(),new MutationObserver(s).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})}const t=document.querySelector(".menu-toggle"),i=document.getElementById("mobile-drawer");if(t&&i){const s=()=>{const a=i.classList.contains("open");t.setAttribute("aria-expanded",a?"true":"false")};new MutationObserver(s).observe(i,{attributes:!0,attributeFilter:["class"]})}i&&i.addEventListener("keydown",s=>{s.key==="Escape"&&Nav.toggleMobile()});const o=document.getElementById("article-modal");o&&o.addEventListener("keydown",s=>{s.key==="Escape"&&Modal.close()})},initRotatingWords(){document.querySelectorAll("[data-words]").forEach(t=>{const i=JSON.parse(t.dataset.words);let o=0;this._intervals.push(setInterval(()=>{t.style.opacity="0",setTimeout(()=>{o=(o+1)%i.length,t.textContent=i[o],t.style.opacity="1"},300)},2500))})},initKonami(){document.addEventListener("keydown",e=>{e.key===this._konamiCode[this._konamiIndex]?(this._konamiIndex++,this._konamiIndex===this._konamiCode.length&&(this._konamiIndex=0,this.triggerEasterEgg())):this._konamiIndex=0})},triggerEasterEgg(){console.log("%c"+`
    \u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591
    \u2591  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2557     \u2588\u2588\u2557     \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557
    \u2591  \u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255D\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255D     \u2588\u2588\u2551     \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255D\u255A\u2550\u2550\u2588\u2588\u2554\u2550\u2550\u255D
    \u2591  \u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2588\u2557    \u2588\u2588\u2551     \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557     \u2588\u2588\u2551
    \u2591  \u2588\u2588\u2554\u2550\u2550\u255D  \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551    \u2588\u2588\u2551     \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255D     \u2588\u2588\u2551
    \u2591  \u2588\u2588\u2551     \u255A\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255D\u255A\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255D    \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551\u2588\u2588\u2551        \u2588\u2588\u2551
    \u2591  \u255A\u2550\u255D      \u255A\u2550\u2550\u2550\u2550\u2550\u255D  \u255A\u2550\u2550\u2550\u2550\u2550\u255D     \u255A\u2550\u2550\u2550\u2550\u2550\u2550\u255D\u255A\u2550\u255D\u255A\u2550\u255D        \u255A\u2550\u255D
    \u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591
        `,"color: #e07b3c; font-family: monospace;"),console.log("%c \u{1F3AE} KONAMI CODE ACTIVATED! ","background: #0d9488; color: white; padding: 10px; font-size: 16px; font-weight: bold;"),console.log("%c You found the secret! Here's a fortune cookie: ","color: #4a2c2a; font-style: italic;");const t=["\u{1F52E} The fog will clear when you stop looking for the sun.","\u{1F52E} Your next breakthrough is hiding in plain sight.","\u{1F52E} Sometimes the answer is a better question.","\u{1F52E} Complexity is easy. Simplicity takes courage.","\u{1F52E} The bottleneck is rarely where you think it is.",'\u{1F52E} Ask "why" five times. The truth lives on the fifth floor.',"\u{1F52E} Your gut knows things your spreadsheet never will.","\u{1F52E} The best documentation is the kind you wish existed."];console.log("%c "+t[Math.floor(Math.random()*t.length)],"color: #e07b3c; font-size: 14px; padding: 5px;"),document.body.style.transition="filter 0.5s",document.body.style.filter="hue-rotate(180deg)",setTimeout(()=>{document.body.style.filter="hue-rotate(360deg)",setTimeout(()=>{document.body.style.filter="none"},500)},500)},logBoot(){console.log("%c FOGSIFT v"+this.version+" // SYSTEMS NOMINAL ","background: #4a2c2a; color: #e07b3c; padding: 10px; font-family: monospace; font-weight: bold; border-left: 5px solid #0d9488;"),console.log('%c \u2328\uFE0F  Press "T" to cycle themes ',"color: #e07b3c; font-family: monospace; font-size: 10px;"),console.log("%c \u{1F3AE} ...or try the old ways. ","color: #999; font-family: monospace; font-size: 10px;")}};document.addEventListener("DOMContentLoaded",()=>App.init()),window.addEventListener("unload",()=>{App._intervals.forEach(e=>clearInterval(e))});
